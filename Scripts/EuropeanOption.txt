using QuantSA;
using MonteCarlo;
using MonteCarlo.Equity;
using System;
using System.Collections.Generic;

public class EuropeanOption : Product
{
    private Date exerciseDate;
    private double fwdPrice;
    private Share share;
    private double strike;

    public EuropeanOption()
    {
        share = new Share("AAA");
        strike = 100.0;
        exerciseDate = new Date(2017, 08, 28);
    }

    public override double[,] GetCFs()
    {
        return new double[,] { { exerciseDate, Math.Max(0, fwdPrice-strike) } };
    }

    public override IEnumerable<MarketObservable> GetRequiredIndices()
    {
        return new List<MarketObservable> { share };
    }

    public override int[] GetRequiredTimes(Date valueDate, MarketObservable index)
    {
        if (valueDate.date <= exerciseDate.date)
        {
            return new int[] { exerciseDate };
        }
        else
        {
            return null;
        }
    }

    public override void SetIndices(MarketObservable index, double[] indices)
    {
        fwdPrice = indices[0];
    }
}
